<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Pga services</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.8.0/application.js' type='text/javascript'></script>    
    <link href='./assets/0.8.0/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.8.0/favicon_red.png" />
    <link rel="icon" type="image/png" href="./assets/0.8.0/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.8.0/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2015-01-22T18:40:44-02:00">2015-01-22T18:40:44-02:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="red">3.31%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.03
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>2</b> files in total.
    <b>151</b> relevant lines. 
    <span class="green"><b>5</b> lines covered</span> and
    <span class="red"><b>146</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#5855419e00bf87c7c937b8ae5926c6cf63a3649a" class="src_link" title="lib/pga_services.rb">lib/pga_services.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#87e29f23ec1ebccd793255541e1e5455738ca54e" class="src_link" title="lib/pga_services/services.rb">lib/pga_services/services.rb</a></td>
        <td class="red strong">1.35 %</td>
        <td>262</td>
        <td>148</td>
        <td>2</td>
        <td>146</td>
        <td>0.0</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.9.1 
        and simplecov-html v0.8.0<br/>
        using RSpec
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="5855419e00bf87c7c937b8ae5926c6cf63a3649a">
  <div class="header">
    <h3>lib/pga_services.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;pga_services/version&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">module PGA</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # Gem files</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="5">
          <span class="hits">3</span>
          
          <code class="ruby">  [:version, :services].each { |lib| require &quot;pga_services/#{lib}&quot; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="87e29f23ec1ebccd793255541e1e5455738ca54e">
  <div class="header">
    <h3>lib/pga_services/services.rb</h3>
    <h4><span class="red">1.35 %</span> covered</h4>
    <div>
      <b>148</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>146</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module PGA</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">  #query = &quot;id2tipolocal = &#39;04&#39; and ID2LOCATIONUSERCUST.PERSONID = &#39;#{cpf}&#39;&quot; ==&gt; Query BACK-UP</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  APP_CONFIG = YAML.load_file(__FILE__ + &#39;configs/services.yml&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">  WSDL_URL_CNA_CARD = APP_CONFIG[&#39;wsdl_url_cna_card&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">  WSDL_URL_PROTOCOLOS_QUERY = APP_CONFIG[&#39;wsdl_url_protocols_query&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">  WSDL_URL_GTA = APP_CONFIG[&#39;wsdl_url_gta&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">  WSDL_URL_GTAS_ANIMALS = APP_CONFIG[&#39;wsdl_url_earring_gtas&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">  WSDL_URL_PRODUTOR_EMAIL = APP_CONFIG[&#39;wsdl_url_produtor_email&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">  WSDL_URL_PROP_SEM_CONTATO = APP_CONFIG[&#39;wsdl_url_prop_sem_contato&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">  WSDL_URL_SLAUGHTERHOUSE = APP_CONFIG[&#39;wsdl_url_slaughterhouse&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">  WSDL_URL_GEOLOC = APP_CONFIG[&#39;wsdl_url_geoloc&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">  class Services</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    @cpf_produtor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    attr_accessor :current_gta</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    def get_instance</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">      PGA::Services.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    # Para listar as funcionalidades: @cliente.operations</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      # Criação e configuração dos Clientes Savon</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      @cliente_cna = create_cliente_pga WSDL_URL_CNA_CARD</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      @cliente_protocolo = create_cliente_pga WSDL_URL_PROTOCOLOS_QUERY</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      @cliente_gta = create_cliente_pga WSDL_URL_GTA</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      @cliente_earrings_gtas = create_cliente_pga WSDL_URL_GTAS_ANIMALS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">      @cliente_prop_sem_contato = create_cliente_pga WSDL_URL_PROP_SEM_CONTATO</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">      @client_slaughterhouse = create_cliente_pga WSDL_URL_SLAUGHTERHOUSE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">      @client_produtor_email = create_cliente_pga WSDL_URL_PRODUTOR_EMAIL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">      @client_geoloc = create_cliente_pga WSDL_URL_GEOLOC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    def auth_pga email, senha</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      crypt = Base64.strict_encode64(&quot;#{email}:#{senha}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      @cliente_usuario = Savon.client(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">          wsdl: WSDL_URL_PROTOCOLOS_QUERY,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">          namespace: &#39;http://www.ibm.com/maximo&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">          namespace_identifier: nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">          convert_request_keys_to: :none,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">          soap_header: { &#39;Authorization&#39; =&gt; &quot;Basic #{crypt}&quot; },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">          pretty_print_xml: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">          log: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    def conectado?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">      # return false if @cliente.nil? else return true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      @cliente_cna.nil? ? false : true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      @cliente_protocolo.nil? ? false : true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    # Cria um cliente PGA de forma facilitada</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    def create_cliente_pga url</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">      crypt_senha_root = Base64.strict_encode64(&quot;maxadmin:123456&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      return Savon.client(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">          wsdl: url,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">          namespace: &#39;http://www.ibm.com/maximo&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">          namespace_identifier: nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">          convert_request_keys_to: :none,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">          soap_header: { &#39;Authorization&#39; =&gt; &quot;Basic #{crypt_senha_root}&quot; },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">          pretty_print_xml: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">          log: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    # Exploração Bovina do produtor corrente</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    def get_exploracoes cpf_produtor, validacao_sisbov = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">      # 04 é a exploração</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">      query = &quot;id2tipolocal=04 AND exists (select 1 from id2locationusercust where personid=&#39;#{cpf_produtor}&#39; AND location=locations.location)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">      query = query + &quot; AND maadesao=1&quot; if validacao_sisbov</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">      @exploracoes = @cliente_cna.call(:query_locations, message: { LOCATIONSQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">      locations_set = @exploracoes.body[:query_locations_response][:locations_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      locations_set.nil? ? nil : locations_set[:locations]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">      #locations_set.nil? ? nil : locations_set[:locations]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    # Todos dados cadastrais da Propriedade e seu Dono</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    def get_propriedade cod_prop, validacao_sisbov = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">      # 01 é a propriedade</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">      query = &quot;location=&#39;#{cod_prop}&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">      query = query + &quot; AND id2eras=1&quot; if validacao_sisbov</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">      @propriedades = @cliente_cna.call(:query_locations, message: { LOCATIONSQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">      locations_set = @propriedades.body[:query_locations_response][:locations_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">      locations_set.nil? ? [] : locations_set[:locations]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    def get_brincos_ativos cod_exploracao</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">      # Status define se está indo ser entregue (EM TRANSITO) ou já com o proprietário (EM USO)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">      query = &quot;status=&#39;EM USO&#39; AND maestratificacao IS NOT NULL AND location=&#39;#{cod_exploracao}&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">      @exploracao = @cliente_protocolo.call(:query_asset, message: { ASSETQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">      asset_set = @exploracao.body[:query_asset_response][:asset_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">      animals = asset_set[:asset] unless asset_set.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">      animals = [animals] if animals.is_a?Hash</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">      asset_set.nil? ? [] : animals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    def get_brincos_estoque cod_exploracao</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">      # Status define se está indo ser entregue (EM ESTOQUE) ou já com o proprietário (EM USO)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">      query = &quot;status=&#39;EM ESTOQUE&#39; AND maestratificacao IS NULL AND location=&#39;#{cod_exploracao}&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">      @exploracao = @cliente_protocolo.call(:query_asset, message: { ASSETQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">      asset_set = @exploracao.body[:query_asset_response][:asset_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      animals = asset_set[:asset] unless asset_set.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">      animals = [animals] if animals.is_a?Hash</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">      asset_set.nil? ? nil : animals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    # Recupera as explorações da mesma propriedade de uma outra exploração</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">    def exploracoes_irma codprop, validacao_sisbov = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      # 01 é a propriedade e 04 é exploração</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      query = &quot;id2tipolocal=04 AND id2codprop=&#39;#{codprop}&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">      query = query + &quot; AND maadesao=1&quot; if validacao_sisbov</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">      @exploracoes = @cliente_cna.call(:query_locations, message: { LOCATIONSQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">      locations_set = @exploracoes.body[:query_locations_response][:locations_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">      locations_set.nil? ? nil : locations_set[:locations]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    # Pegas as GTAs envolvidas entre CPFs (Produtores)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">    def get_gtas_produtor_produtor cpf_produtor, cod_exploracao</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">      # Query de busca pelo CPF e Cod_Eploracao</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">      query_recebidas = &quot;(ID2DESEXPCOD = &#39;#{cod_exploracao}&#39; AND ID2DESEXPPER = &#39;#{cpf_produtor}&#39; AND STATUS NOT IN (&#39;GRAVADA&#39;))&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">      query_enviadas = &quot;(ID2PROEXPCOD = &#39;#{cod_exploracao}&#39; AND ID2PROEXPPER = &#39;#{cpf_produtor}&#39; AND STATUS NOT IN (&#39;GRAVADA&#39;))&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">      @gtas_recebidas = @cliente_gta.call(:query_mxgtacnacard, message: { MXGTACNACARDQuery: { WHERE: query_recebidas } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">      @gtas_enviadas = @cliente_gta.call(:query_mxgtacnacard, message: { MXGTACNACARDQuery: { WHERE: query_enviadas } })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">      mx_gta_cnacard_recebidas = @gtas_recebidas.body[:query_mxgtacnacard_response][:mxgtacnacard_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">      mx_gta_cnacard_enviadas = @gtas_enviadas.body[:query_mxgtacnacard_response][:mxgtacnacard_set]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">      retorno_recebidas = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">      retorno_enviadas = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">      if mx_gta_cnacard_recebidas.nil? then retorno_recebidas = { erro: &#39;sem_recebidas&#39; } else retorno_recebidas &lt;&lt; mx_gta_cnacard_recebidas[:po] end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">      if mx_gta_cnacard_enviadas.nil? then retorno_enviadas = { erro: &#39;sem_enviadas&#39; } else retorno_enviadas &lt;&lt; mx_gta_cnacard_enviadas[:po] end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="138">
          
          
          <code class="ruby">      if mx_gta_cnacard_recebidas.nil? &amp;&amp; mx_gta_cnacard_enviadas.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">        retorno_recebidas = { erro: &#39;CPF ou CodPropriedade inválidos&#39; }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">        retorno_enviadas = { erro: &#39;CPF ou CodPropriedade inválidos&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">      retorno = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">      retorno[:gtas_recebidas] = retorno_recebidas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">      retorno[:gtas_enviadas] = retorno_enviadas</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">      retorno</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">    # Pegas as GTAs envolvidas p/ propriedade rural</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">    def get_gtas_propriedade codprop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      # Query de busca pelo CodProp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">      query_recebidas = &quot;(ID2DESEXPPROP = &#39;#{codprop}&#39; AND STATUS NOT IN (&#39;GRAVADA&#39;))&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">      # GTAs complete Response</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">      @gtas_recebidas = @cliente_gta.call(:query_mxgtacnacard, message: { MXGTACNACARDQuery: { WHERE: query_recebidas } })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">      # MX GTA (only the attrs)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">      mx_gta_cnacard_recebidas = @gtas_recebidas.body[:query_mxgtacnacard_response][:mxgtacnacard_set]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">      # Prepair what to return</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">      if mx_gta_cnacard_recebidas.nil? then retorno_recebidas = { erro: &#39;sem_recebidas&#39; } else retorno_recebidas = mx_gta_cnacard_recebidas[:po] end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">      return retorno_recebidas</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">    # Pegas as GTAs envolvidas no CPF p/ Abatedoro</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">    def get_gtas_produtor_abatedoro cpf_produtor, cod_exploracao</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">      # Query de busca pelo CPF e Cod_Eploracao</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">      query = &quot;(ID2PROEXPCOD = &#39;#{cod_exploracao}&#39; AND ID2PROEXPPER = &#39;#{cpf_produtor}&#39; AND STATUS NOT IN (&#39;GRAVADA&#39;))&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">      @gtas = @cliente_gta.call(:query_mxgtacnacard, message: { MXGTACNACARDQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">      mx_gta_cnacard = @gtas.body[:query_mxgtacnacard_response][:mxgtacnacard_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">      mx_gta_cnacard.nil? ? nil : mx_gta_cnacard[:po]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">    def get_gta_by_identifier serie, number, uf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">      # Query de busca pelo CPF e Cod_Eploracao</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">      query = &quot;(ID2SERIE=&#39;#{serie}&#39; AND ID2NUMGTA=&#39;#{number}&#39; AND ID2ADDUF=&#39;#{uf}&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="178">
          
          
          <code class="ruby">      @gtas = @cliente_gta.call(:query_mxgtacnacard, message: { MXGTACNACARDQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">      mx_gta_cnacard = @gtas.body[:query_mxgtacnacard_response][:mxgtacnacard_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="180">
          
          
          <code class="ruby">      return nil if mx_gta_cnacard.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">      gta = mx_gta_cnacard[:po]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">      gta[:poline] = [gta[:poline]] if gta[:poline].is_a?Hash</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">      self.current_gta = gta</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">      return gta</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">    def get_earring_transference_in_period earring, period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">      # Query de busca pelo Brinco no Range do Periodo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">      query = &quot;assetnum=&#39;#{earring}&#39; AND exists (SELECT 1 FROM postatus WHERE changedate BETWEEN sysdate-#{period} AND sysdate)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">      # GTAs from it earring</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="192">
          
          
          <code class="ruby">      @earrings_received = @cliente_earrings_gtas.call(:query_gta_brincos, message: { GTA_BRINCOSQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">      gta_earrings = @earrings_received.body[:query_gta_brincos_response][:gta_brincos_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">      gta_earrings.nil? ? [] : [gta_earrings[:matbtransani]] # Empty array means no earring transference, is the better scene</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="197">
          
          
          <code class="ruby">    def time_without_gta codprop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">      # Query de busca pelo Brinco no Range do Periodo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">      query = &quot;maestrurid=&#39;#{codprop}&#39;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      # Retrive it time</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">      counter_xml = @cliente_prop_sem_contato.call(:query_dias_sem_contato, message: { DIAS_SEM_CONTATOQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">      counter_set = counter_xml.body[:query_dias_sem_contato_response][:dias_sem_contato_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="204">
          
          
          <code class="ruby">      counter = counter_set[:matbcon] unless counter_set.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="205">
          
          
          <code class="ruby">      counter = {madiacontid:0,maestrurid:0,mamicregid:0} if counter_set.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">      return {days_counter:counter[:madiacontid].to_i, property:counter[:maestrurid].to_i, zone:counter[:mamicregid].to_i}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">    # Return the slaughterhouse based on it SIF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">    def get_slaughterhouse_by sif</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">      query = &quot;id2numcont=&#39;#{sif}&#39;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">        slaughterhouse_xml = @client_slaughterhouse.call(:query_frigorifico, message:{ FRIGORIFICOQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">        slaughterhouse_set = slaughterhouse_xml.body[:query_frigorifico_response][:frigorifico_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="216">
          
          
          <code class="ruby">        slaughterhouse = slaughterhouse_set[:id2_vwloc02]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">        cnpj = slaughterhouse[:person][:personid]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">        name = slaughterhouse[:person][:displayname]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="219">
          
          
          <code class="ruby">        sif = slaughterhouse[:id2_numcont]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="220">
          
          
          <code class="ruby">        uf = State.where(symbol: slaughterhouse[:id2_adduf]).take.id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="221">
          
          
          <code class="ruby">        return_hash = {cnpj: cnpj, name: name, sif: sif, uf: uf}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">      rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">        return_hash = {error:e.message}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">      # Person have it name &amp; CNPJ</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">      return return_hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">    # Return it produtor email</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">    def get_full_person cpf</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="232">
          
          
          <code class="ruby">      query = &quot;personid=&#39;#{cpf}&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="233">
          
          
          <code class="ruby">      email_xml = @client_produtor_email.call(:query_person, message:{ PERSONQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="234">
          
          
          <code class="ruby">      email_set = email_xml.body[:query_person_response][:person_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">      email_set[:person][:email] = {emailaddress:nil} if email_set[:person][:email].nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">      email_set.nil? ? {error:&#39;CPF não encontrado na PGA&#39;} : email_set[:person]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="239">
          
          
          <code class="ruby">    def get_geoposicionamento id_propriedade, validacao_sisbov = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">      # Campos úteis: ID2UTMLAT (Latitude) ID2UTMLON (Longitude)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">      query = &quot;location=&#39;#{id_propriedade}&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="242">
          
          
          <code class="ruby">      query = query + &quot; AND id2eras=1&quot; if validacao_sisbov</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">      @utm_geoposicionamento = @client_geoloc.call(:query_coordenadas, message: { COORDENADASQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">      coordinate_set = @utm_geoposicionamento.body[:query_coordenadas_response][:coordenadas_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">      coordinate_set.nil? ? {latitude:nil, longitude:nil} : {latitude:coordinate_set[:id2_cooext][:id2_utmlat], longitude:coordinate_set[:id2_cooext][:id2_utmlon]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">    # GET the transported animals (it earrings) USING TAI WSDL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">    def get_transported_animals maponum_gta_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">      # GTA.XXXXXXX.2014 is the AnimalTraffic(GTA) id on the PGA</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">      query = &quot;ponum = &#39;#{maponum_gta_id}&#39;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">      animals_xml = @cliente_earrings_gtas.call(:query_gta_brincos, message: { GTA_BRINCOSQuery: { WHERE: query } })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">      animals_set = animals_xml.body[:query_gta_brincos_response][:gta_brincos_set]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">      return [] if animals_set.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="256">
          
          
          <code class="ruby">      animals = animals_set[:matbtransani]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">      animals = [animals] if animals.is_a? Hash || animals.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">      return animals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
      </div>
    </div>
  </body>
</html>
